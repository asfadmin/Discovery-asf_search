sentinel-1_collections: &sentinel-1_collections
  - "C2803501758-ASF"
  - "C2803501097-ASF"
  - "C1261881077-ASF"
  - "C2859376221-ASF"
  - "C1214470488-ASF" # S1A
  - "C1214470533-ASF"
  - "C1214470576-ASF"
  - "C1595422627-ASF"
  - "C1214470496-ASF"
  - "C1214470532-ASF"
  - "C1214472977-ASF"
  - "C1214472336-ASF"
  - "C1266376001-ASF"
  - "C1214472994-ASF"
  - "C1214470732-ASF"
  - "C1214473170-ASF"
  - "C1214470561-ASF"
  - "C1214471521-ASF"
  - "C1214470682-ASF"
  - "C2777443834-ASF"
  - "C2777436413-ASF"
  - "C1214471197-ASF"
  - "C1214471960-ASF"
  - "C1214472978-ASF"
  - "C1214473165-ASF"
  - "C2709161906-ASF"
  - "C1596065640-ASF"
  - "C1596065639-ASF"
  - "C1596065641-ASF"
  - "C1595765183-ASF"
  - "C2450786986-ASF"
  - "C1205428742-ASF"
  - "C1212201032-ASF"
  - "C1212212560-ASF"
  - "C1205264459-ASF"
  - "C1208117434-ASF"
  - "C1212209035-ASF"
  - "C1212209226-ASF"
  - "C1208115009-ASF"
  - "C1212158327-ASF"
  - "C1215704763-ASF"
  - "C1225776654-ASF"
  - "C1212158318-ASF"
  - "C1212212493-ASF"
  - "C1212158326-ASF"
  - "C1212233976-ASF"
  - "C1260726384-ASF"
  - "C1258354200-ASF"
  - "C1259982010-ASF"
  - "C2795135668-ASF"
  - "C1260721945-ASF"
  - "C1257995185-ASF"
  - "C1259976861-ASF"
  - "C1258354201-ASF"
  - "C1259981910-ASF"
  - "C2795135174-ASF"
  - "C1260721853-ASF"
  - "C1257995186-ASF"
  - "C1259974840-ASF"
  - "C1212200781-ASF"
  - "C1212209075-ASF"
  - "C1257024016-ASF"
  - "C1225776655-ASF"
  - "C1225776657-ASF"
  - "C1225776658-ASF"
  - "C1225776659-ASF"
  - "C1245953394-ASF"
  - "C1234413245-ASFDEV"
  - "C1234413229-ASFDEV"
  - "C1234413237-ASFDEV"
  - "C1234413238-ASFDEV"
  - "C1234413236-ASFDEV"
  - "C1234413230-ASFDEV"
  - "C1234413232-ASFDEV"
  - "C1234413235-ASFDEV"
  - "C1234413240-ASFDEV"
  - "C1234413234-ASFDEV"
  - "C1234413241-ASFDEV"
  - "C1234413233-ASFDEV"
  - "C1234413243-ASFDEV"
  - "C1234413244-ASFDEV"
  - "C1244552887-ASFDEV"
  - "C1234413228-ASFDEV"
  - "C1234413231-ASFDEV"
  - "C1234413239-ASFDEV"
  - "C1234413242-ASFDEV"
  - "C1257175154-ASFDEV"
  - "C1244598379-ASFDEV"
  - "C1240784657-ASFDEV"
  - "C1327985661-ASF" # S1B
  - "C1327985645-ASF"
  - "C1595422627-ASF"
  - "C1327985617-ASF"
  - "C1327985660-ASF"
  - "C1327985741-ASF"
  - "C1327985578-ASF"
  - "C1327985646-ASF"
  - "C1327985650-ASF"
  - "C1327985579-ASF"
  - "C1327985740-ASF"
  - "C1327985619-ASF"
  - "C1327985739-ASF"
  - "C1327985647-ASF"
  - "C2777443834-ASF"
  - "C2777436413-ASF"
  - "C1327985697-ASF"
  - "C1327985651-ASF"
  - "C1327985644-ASF"
  - "C1327985571-ASF"
  - "C1327985674-ASF"
  - "C2709161906-ASF"
  - "C1596065640-ASF"
  - "C1596065639-ASF"
  - "C1596065641-ASF"
  - "C1595765183-ASF"
  - "C2450786986-ASF"
  - "C1216244348-ASF"
  - "C1216244589-ASF"
  - "C1216244594-ASF"
  - "C1216244593-ASF"
  - "C1216244585-ASF"
  - "C1216244592-ASF"
  - "C1216244595-ASF"
  - "C1225776654-ASF"
  - "C1216244590-ASF"
  - "C1216244601-ASF"
  - "C1216244600-ASF"
  - "C1216244591-ASF"
  - "C1216244587-ASF"
  - "C1216244598-ASF"
  - "C1216244586-ASF"
  - "C1260726384-ASF"
  - "C1258354200-ASF"
  - "C1259982010-ASF"
  - "C2795135668-ASF"
  - "C1260721945-ASF"
  - "C1257995185-ASF"
  - "C1259976861-ASF"
  - "C1258354201-ASF"
  - "C1259981910-ASF"
  - "C2795135174-ASF"
  - "C1260721853-ASF"
  - "C1257995186-ASF"
  - "C1259974840-ASF"
  - "C1216244597-ASF"
  - "C1216244596-ASF"
  - "C1216244588-ASF"
  - "C1216244599-ASF"
  - "C1257024016-ASF"
  - "C1225776655-ASF"
  - "C1225776657-ASF"
  - "C1225776658-ASF"
  - "C1225776659-ASF"
  - "C1245953394-ASF"
  - "C1234413263-ASFDEV"
  - "C1234413247-ASFDEV"
  - "C1234413248-ASFDEV"
  - "C1234413255-ASFDEV"
  - "C1234413254-ASFDEV"
  - "C1234413256-ASFDEV"
  - "C1234413253-ASFDEV"
  - "C1234413252-ASFDEV"
  - "C1234413250-ASFDEV"
  - "C1234413259-ASFDEV"
  - "C1234413251-ASFDEV"
  - "C1234413261-ASFDEV"
  - "C1234413262-ASFDEV"
  - "C1234413258-ASFDEV"
  - "C1244552887-ASFDEV"
  - "C1234413246-ASFDEV"
  - "C1234413249-ASFDEV"
  - "C1234413257-ASFDEV"
  - "C1234413260-ASFDEV"
  - "C1257175154-ASFDEV"
  - "C1244598379-ASFDEV"

tests:
  - test-ASFSearch ALOS Resp 1:
      response: Alos_response_maxResults3.yml
  - test-ASFSearch S1 Resp 1:
      response: S1_baseline_stack.yml
  - test-ASFSearch-search-valid Alos:
      parameters:
        platform: ALOS
        maxResults: 3
      answer: Alos_response_maxResults3.yml
  - test-ASFSearch-search-error 400-Error:
      parameters: {}
      status_code: 400
      report: 'Client Error: This is a Test Error'
  - test-ASFSearch-search-error 400-Error non-empty-results:
      parameters:
        platform: Sentinel-1
      status_code: 400
      report: 'Client Error: This is a Test Error'
  - test-ASFSearch-search-error 500-Error:
      parameters: {}
      status_code: 500
      report: 'Server Error: This is a Test Error'
  - test-ASFSearch-search-error 500-Error non-empty-results:
      parameters:
        platform: Sentinel-1
      status_code: 500
      report: 'Server Error: This is a Test Error'
  - test-search-dataset S1 Datasets:
      dataset:
        - SENTINEL-1
        - SLC-BURST
        - OPERA-S1
  - test-search-dataset S1 Datasets and non-S1:
      dataset:
        - SENTINEL-1
        - SLC-BURST
        - OPERA-S1
        - UAVSAR
  - test-search-dataset fake dataset:
      dataset: FAKE-DATASET-V1
  - test-search-dataset S1 Datasets and fake dataset:
      dataset:
        - SENTINEL-1
        - SLC-BURST
        - OPERA-S1
        - FAKE-DATASET-V2
  - test-search-build_subquery S1-Platform:
      params:
        platform:
          - SENTINEL-1A
          - SENTINEL-1B
      expected:
        - collections: *sentinel-1_collections

  - test-search-build_subquery S1-Platform SLC:
      params:
        platform:
          - SENTINEL-1A
          - SENTINEL-1B
        processingLevel:
          - SLC
      expected:
        - collections:
          - 'C1205428742-ASF'
          - 'C1214470488-ASF'
          - 'C1216244348-ASF'
          - 'C1234413245-ASFDEV'
          - 'C1234413263-ASFDEV'
          - 'C1327985661-ASF'
  - test-search-build_subquery S1-Dataset SLC:
      params:
        dataset:
          - SENTINEL-1
        processingLevel:
          - SLC
      expected:
        - collections:
            - C1214470488-ASF
            - C1205428742-ASF
            - C1234413245-ASFDEV
            - C1327985661-ASF
            - C1216244348-ASF
            - C1234413263-ASFDEV
  - test-search-build_subquery INTERFEROMETRY:
      params:
        processingLevel:
          - INTERFEROMETRY
      expected:
        - collections:
            - C1214336045-ASF
            - C1212001698-ASF
  - test-search-build_subquery INTERFEROMETRY & SLC Collection:
      params:
        processingLevel:
          - INTERFEROMETRY
        collections:
          - C1214470488-ASF
          - C1205428742-ASF
          - C1234413245-ASFDEV
          - C1327985661-ASF
          - C1216244348-ASF
          - C1234413263-ASFDEV
      expected:
        - collections:
            - C1214336045-ASF
            - C1212001698-ASF
            - C1214470488-ASF
            - C1205428742-ASF
            - C1234413245-ASFDEV
            - C1327985661-ASF
            - C1216244348-ASF
            - C1234413263-ASFDEV
  - test-search-build_subquery INTERFEROMETRY & SLC Collection with duplicate INTERFEROMETRY collection:
      params:
        processingLevel:
          - INTERFEROMETRY
        collections:
          - C1214470488-ASF
          - C1205428742-ASF
          - C1234413245-ASFDEV
          - C1327985661-ASF
          - C1216244348-ASF
          - C1234413263-ASFDEV
          - C1212001698-ASF
      expected:
        - collections:
            - C1214336045-ASF
            - C1212001698-ASF
            - C1214470488-ASF
            - C1205428742-ASF
            - C1234413245-ASFDEV
            - C1327985661-ASF
            - C1216244348-ASF
            - C1234413263-ASFDEV
  - test-search-build_subquery UNKNOWN_PROCESSING_TYPE:
      params:
        processingLevel:
          - UNKNOWN_PROCESSING_TYPE
      expected: [
        {processingLevel: [UNKNOWN_PROCESSING_TYPE]}
      ]
  - test-search-build_subquery UNKNOWN_PROCESSING_TYPE with collections:
      params:
        processingLevel:
          - UNKNOWN_PROCESSING_TYPE
        collections:
          - C1214470488-ASF
          - C1205428742-ASF
          - C1234413245-ASFDEV
          - C1327985661-ASF
          - C1216244348-ASF
          - C1234413263-ASFDEV
          - C1212001698-ASF
      expected: [
        {
        processingLevel: [UNKNOWN_PROCESSING_TYPE],
        collections: [C1214470488-ASF,
            C1205428742-ASF,
            C1234413245-ASFDEV,
            C1327985661-ASF,
            C1216244348-ASF,
            C1234413263-ASFDEV,
            C1212001698-ASF]
        }
      ]
  - test-search-build_subquery UNKNOWN_PROCESSING_TYPE with platform, SLC, & collection (skip set difference with unknown processing level):
      params:
        platform:
          - SENTINEL-1A
          - SENTINEL-1B
          - UAVSAR
        processingLevel:
          - UNKNOWN_PROCESSING_TYPE
          - SLC
        collections:
          - C1212001698-ASF
      expected: [{
        processingLevel: UNKNOWN_PROCESSING_TYPE,
        collections: [
            "C1214353986-ASF",
            "C1214336045-ASF",
            "C1261881077-ASF",
            "C2859376221-ASF",
            "C1214336717-ASF",
            "C1214335430-ASF",
            "C1214335471-ASF",
            "C1214335903-ASF",
            "C1214336154-ASF",
            "C1214336554-ASF",
            "C1214353593-ASF",
            "C1214353754-ASF",
            "C1214353859-ASF",
            "C1214337770-ASF",
            "C1214354144-ASF",
            "C1214354235-ASF",
            "C1214343609-ASF",
            "C1214354031-ASF",
            "C1214408428-ASF",
            "C1214419355-ASF",
            "C1210487703-ASF",
            "C1212030772-ASF",
            "C1206116665-ASF",
            "C1206132445-ASF",
            "C1211962154-ASF",
            "C1212001698-ASF",
            "C1212005594-ASF",
            "C1212019993-ASF",
            "C1207638502-ASF",
            "C1210025872-ASF",
            "C1210485039-ASF",
            "C1207188317-ASF",
            "C1210546638-ASF",
            "C1206122195-ASF",
            "C1209970710-ASF",
            "C1207038647-ASF",
            "C1210599503-ASF",
            "C1210599673-ASF",
            "C1214470488-ASF",
            "C1205428742-ASF",
            "C1234413245-ASFDEV",
            "C1327985661-ASF",
            "C1216244348-ASF",
            "C1234413263-ASFDEV",
            "C2803501758-ASF", # OPERA
            "C2803501097-ASF", # OPERA
            "C1214470488-ASF", # S1A
            "C1214470533-ASF",
            "C1214470576-ASF",
            "C1595422627-ASF",
            "C1214470496-ASF",
            "C1214470532-ASF",
            "C1214472977-ASF",
            "C1214472336-ASF",
            "C1266376001-ASF",
            "C1214472994-ASF",
            "C1214470732-ASF",
            "C1214473170-ASF",
            "C1214470561-ASF",
            "C1214471521-ASF",
            "C1214470682-ASF",
            "C2777443834-ASF",
            "C2777436413-ASF",
            "C1214471197-ASF",
            "C1214471960-ASF",
            "C1214472978-ASF",
            "C1214473165-ASF",
            "C2709161906-ASF",
            "C1596065640-ASF",
            "C1596065639-ASF",
            "C1596065641-ASF",
            "C1595765183-ASF",
            "C2450786986-ASF",
            "C1205428742-ASF",
            "C1212201032-ASF",
            "C1212212560-ASF",
            "C1205264459-ASF",
            "C1208117434-ASF",
            "C1212209035-ASF",
            "C1212209226-ASF",
            "C1208115009-ASF",
            "C1212158327-ASF",
            "C1215704763-ASF",
            "C1225776654-ASF",
            "C1212158318-ASF",
            "C1212212493-ASF",
            "C1212158326-ASF",
            "C1212233976-ASF",
            "C1260726384-ASF",
            "C1258354200-ASF",
            "C1259982010-ASF",
            "C2795135668-ASF",
            "C1260721945-ASF",
            "C1257995185-ASF",
            "C1259976861-ASF",
            "C1258354201-ASF",
            "C1259981910-ASF",
            "C2795135174-ASF",
            "C1260721853-ASF",
            "C1257995186-ASF",
            "C1259974840-ASF",
            "C1212200781-ASF",
            "C1212209075-ASF",
            "C1257024016-ASF",
            "C1225776655-ASF",
            "C1225776657-ASF",
            "C1225776658-ASF",
            "C1225776659-ASF",
            "C1245953394-ASF",
            "C1234413245-ASFDEV",
            "C1234413229-ASFDEV",
            "C1234413237-ASFDEV",
            "C1234413238-ASFDEV",
            "C1234413236-ASFDEV",
            "C1234413230-ASFDEV",
            "C1234413232-ASFDEV",
            "C1234413235-ASFDEV",
            "C1234413240-ASFDEV",
            "C1234413234-ASFDEV",
            "C1234413241-ASFDEV",
            "C1234413233-ASFDEV",
            "C1234413243-ASFDEV",
            "C1234413244-ASFDEV",
            "C1244552887-ASFDEV",
            "C1234413228-ASFDEV",
            "C1234413231-ASFDEV",
            "C1234413239-ASFDEV",
            "C1234413242-ASFDEV",
            "C1257175154-ASFDEV",
            "C1244598379-ASFDEV",
            "C1240784657-ASFDEV",
            "C1327985661-ASF", # S1B
            "C1327985645-ASF",
            "C1595422627-ASF",
            "C1327985617-ASF",
            "C1327985660-ASF",
            "C1327985741-ASF",
            "C1327985578-ASF",
            "C1327985646-ASF",
            "C1327985650-ASF",
            "C1327985579-ASF",
            "C1327985740-ASF",
            "C1327985619-ASF",
            "C1327985739-ASF",
            "C1327985647-ASF",
            "C2777443834-ASF",
            "C2777436413-ASF",
            "C1327985697-ASF",
            "C1327985651-ASF",
            "C1327985644-ASF",
            "C1327985571-ASF",
            "C1327985674-ASF",
            "C2709161906-ASF",
            "C1596065640-ASF",
            "C1596065639-ASF",
            "C1596065641-ASF",
            "C1595765183-ASF",
            "C2450786986-ASF",
            "C1216244348-ASF",
            "C1216244589-ASF",
            "C1216244594-ASF",
            "C1216244593-ASF",
            "C1216244585-ASF",
            "C1216244592-ASF",
            "C1216244595-ASF",
            "C1225776654-ASF",
            "C1216244590-ASF",
            "C1216244601-ASF",
            "C1216244600-ASF",
            "C1216244591-ASF",
            "C1216244587-ASF",
            "C1216244598-ASF",
            "C1216244586-ASF",
            "C1260726384-ASF",
            "C1258354200-ASF",
            "C1259982010-ASF",
            "C2795135668-ASF",
            "C1260721945-ASF",
            "C1257995185-ASF",
            "C1259976861-ASF",
            "C1258354201-ASF",
            "C1259981910-ASF",
            "C2795135174-ASF",
            "C1260721853-ASF",
            "C1257995186-ASF",
            "C1259974840-ASF",
            "C1216244597-ASF",
            "C1216244596-ASF",
            "C1216244588-ASF",
            "C1216244599-ASF",
            "C1257024016-ASF",
            "C1225776655-ASF",
            "C1225776657-ASF",
            "C1225776658-ASF",
            "C1225776659-ASF",
            "C1245953394-ASF",
            "C1234413263-ASFDEV",
            "C1234413247-ASFDEV",
            "C1234413248-ASFDEV",
            "C1234413255-ASFDEV",
            "C1234413254-ASFDEV",
            "C1234413256-ASFDEV",
            "C1234413253-ASFDEV",
            "C1234413252-ASFDEV",
            "C1234413250-ASFDEV",
            "C1234413259-ASFDEV",
            "C1234413251-ASFDEV",
            "C1234413261-ASFDEV",
            "C1234413262-ASFDEV",
            "C1234413258-ASFDEV",
            "C1244552887-ASFDEV",
            "C1234413246-ASFDEV",
            "C1234413249-ASFDEV",
            "C1234413257-ASFDEV",
            "C1234413260-ASFDEV",
            "C1257175154-ASFDEV",
            "C1244598379-ASFDEV",
          ]
        }]

  - test-search-build_subquery shortName:
      params:
        shortName: 'newShortName'
      expected:
        - shortName: ['newShortName']

  - test-search-build_subquery shortName multiple:
      params:
        shortName: ['newShortName', 'oldShortName']
      expected:
        - shortName: ['newShortName', 'oldShortName']

  - test-search-build_subquery cmr_keywords:
      params:
        cmr_keywords: ['attribute[]', 'unique_value']
      expected:
        - cmr_keywords: [['attribute[]', 'unique_value']]
  - test-search-build_subquery multiple cmr_keywords:
      params:
        cmr_keywords: [['attribute[]', 'unique_value'],['special_key', 'special_value']]
      expected:
        - cmr_keywords: [['attribute[]', 'unique_value'],['special_key', 'special_value']]

  - test-search-build_subquery configuration params:
      params:
        host: 'cmr.uat.earthdata.nasa.gov'
        provider: 'ASFDEV'
        product_list: ['S1_069649_IW1_20151201T232154_VV_73D6-BURST']
      expected: [
        {
          host: 'cmr.uat.earthdata.nasa.gov',
          provider: 'ASFDEV',
          product_list: ['S1_069649_IW1_20151201T232154_VV_73D6-BURST']
        }
      ]

  - test-aliasing-search-against-api SLC:
      params:
        processingLevel: SLC
        start: '2023-12-01T00:00:00Z'
        end: '2023-12-31T00:00:00Z'

  - test-aliasing-search-against-api S1A SLC:
      params:
        platform: SENTINEL-1A
        processingLevel: SLC
        start: '2023-12-01T00:00:00Z'
        end: '2023-12-31T00:00:00Z'

  - test-aliasing-search-against-api S1A RTC:
      params:
        platform: SENTINEL-1A
        processingLevel: RTC
        start: '2023-12-01T00:00:00Z'
        end: '2023-12-31T00:00:00Z'

  - test-aliasing-search-against-api S1A CSLC:
      params:
        platform: SENTINEL-1A
        processingLevel: CSLC
        start: '2023-12-01T00:00:00Z'
        end: '2023-12-31T00:00:00Z'

  - test-ASFSearch-search-error 400-Error circle radius too small:
      parameters:
          circle: [0, 0, 2]
      status_code: 400
      report: "Circle radius must be between 10 and 6000000, but was 2.0"

  - test-aliasing-search-against-api RTC-STATIC:
      params:
        processingLevel: RTC-STATIC

  - test-aliasing-search-against-api CSLC-STATIC:
      params:
        processingLevel: CSLC-STATIC

  - test-aliasing-search-against-api OERA-S1 RTC:
      params:
        dataset: OPERA-S1
        processingLevel: RTC

  - test-ASFSearch OPERA Resp 1:
      response: OPERA_Products.yml

  - test-ASFSearch JERS Resp 1:
      response: JERS_stack.yml

  - test-ASFSearch RADARSAT Resp 1:
      response: RADARSAT_stack.yml

  - test-aliasing-search-against-api S1B SLC:
      params:
        platform: SENTINEL-1B
        processingLevel: SLC

  - test-aliasing-search-against-api SIRC:
      params:
        platform: SIRC

  - test-aliasing-search-against-api SIRC SLC:
      params:
        platform: SIRC
        processingLevel: SLC
    
  - test-aliasing-search-against-api ALOS:
      params:
        platform: ALOS

  - test-aliasing-search-against-api ALOS L1_0:
      params:
        platform: ALOS
        processingLevel: L1_0

  - test-aliasing-search-against-api ERS:
      params:
        platform: ERS

  - test-aliasing-search-against-api ERS1 l0:
      params:
        platform: ERS1
        processingLevel: L0

  - test-aliasing-search-against-api ERS1 l0:
      params:
        platform: ERS1

  - test-aliasing-search-against-api ERS2:
      params:
        platform: ERS2

  - test-aliasing-search-against-api ERS2 l0:
      params:
        platform: ERS2
        processingLevel: L0

  - test-aliasing-search-against-api JERS:
      params:
        platform: JERS

  - test-aliasing-search-against-api JERS l0:
      params:
        platform: JERS
        processingLevel: L0

  - test-aliasing-search-against-api RADARSAT:
      params:
        platform: RADARSAT

  - test-aliasing-search-against-api RADARSAT L0:
      params:
        platform: RADARSAT
        processingLevel: L0
    
  - test-aliasing-search-against-api AIRSAR:
      params:
        platform: AIRSAR

  - test-aliasing-search-against-api AIRSAR LSTOKES:
      params:
        platform: AIRSAR
        processingLevel: LSTOKES

  - test-aliasing-search-against-api SEASAT:
      params:
        platform: SEASAT

  - test-aliasing-search-against-api SMAP:
      params:
        platform: SMAP

  - test-aliasing-search-against-api SMAP L1A_RADAR_RO_HDF5:
      params:
        platform: SMAP
        processingLevel: L1A_RADAR_RO_HDF5
    
  - test-aliasing-search-against-api UAVSAR:
      params:
        platform: UAVSAR

  - test-aliasing-search-against-api UAVSAR AMPLITUDE:
      params:
        platform: UAVSAR
        processingLevel: AMPLITUDE
